---
title: "My Final Project"
author: "Guy Incognito"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
---

<!--
Comments in HTML are like this! 
-->

# SECTION NAME

## Subsection name

Write an intro `index.html` page in blog-post style that summarizes your work. It should have

1. One visualization that best summarizes your work.
1. No more than 200 words of text

```{r, echo = FALSE}

```


#Daniela's Section










































































































































































































































#Arris

```{r}
#loading libraries
library(tidyverse)
library(sf)
library(htmltools)
library(geojsonio)
library(leaflet)
library(USAboundaries)
library(maps)
library(editData)
library(sp)
library(tmaptools)

library(raster)
library(dplyr)
library(mapview)


library(readr)
new_income_for_world <- read_csv("new_income_for_world.csv")
#View(new_income_for_world)


```

```{r}
#getting locations of each country
income_2019 <-new_income_for_world %>%
  select(country,X2019)

country_locations <- tibble(
  country= c("Azerbaijan", "Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Central African Republic","Chad","Chile","China","Colombia","Comoros","Democratic Republic of the Congo", "Republic of the Congo","Costa Rica","Cote d'Ivoire","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Fiji","Finland","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana", "Haiti","Honduras","Hungray","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyz Republic","Lao","Lativa","Lebanon","Lesotho","Liberia","Libya","Lithuania","Luxembourg","North Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Island","Mauritania","Mauritius","Mexico","Federated States of Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar",
"Namibia","Togo","France","Argentina", "Armenia", "Australia","Austria","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines", "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda","Samoa", "San Marino","Sao Tome and Principe","Saudi Arabia", "Senegal","Serbia","Seychelles", "Sierra Leone", "Singapore", "Slovak Republic", "Slovenia", "Solomon Islands", "Somalia", "South Africa", "South Korea", "South Sudan","Spain", "Sri Lanka","St. Kitts and Nevis" ,"St.Lucia", "St. Vincent and the Grenadines", "Sudan", "Suriname", "Swaziland", " Syria", "Tajikistan", "Tanzania",
"Thailand","Timor-Leste", "Togo","Tonga", "Trinidad and Tobago", "Tunisia", "Turkey","Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", "Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen", "Zambia", "Zimbabwe"))

```

```{r}
#still getting locations
country_lat_long <-
  tmaptools::geocode_OSM(country_locations$country)%>%
  as_tibble()
```

```{r}
#changing column names
country_lat_long <- country_lat_long %>% 
  mutate(country = query)
  
```


```{r}

new_income <- new_income %>%
  filter(year == "2019")
  
new_income <- gather(income_for_world, key = "year", value = "income", -country)

```

```{r}
USA_map <-  maps::map("world", plot = FALSE, fill = TRUE)
plot(USA_map)

USA_sf <- USA_map %>% 
  sf::st_as_sf(crs = 4326)

```


```{r}
#joining data sets
country_lat_long <- country_lat_long %>%
  left_join(new_income,by="country")




USA_sf <- rename(USA_sf, country=ID)


USA_sf <- USA_sf %>%
  left_join(country_lat_long,by = "country")


  
```

```{r}
#leaflet map creation
  
basemapC <- leaflet(data = USA_sf ) %>%
  setView(-96,37.8,4) %>% # sets the window to a certain size
  addTiles("MapBox", options = providerTileOptions(
    id = "mapbox.light",
    accessToken = Sys.getenv('MAPBOX_ACCESS_TOKEN')))
bins <- c(0,100,300,400,500,600,900,1000,100000,20000,Inf)
pal <- colorBin("YlOrRd", domain = USA_sf$income, bins = bins)
labels <- sprintf(
  "<strong>%s</strong><br/>%g Consumed ",
  USA_sf$country, USA_sf$income
) %>% lapply(htmltools::HTML)


basemapC %>% 
  addPolygons(
  fillColor = ~pal(income), # fills the bins with color
  weight = 2,
  opacity = 1,
  color = "white",
  dashArray = "3",
  fillOpacity = 0.7,
  highlight = highlightOptions(#for when you hover over
    weight = 3,
    color = "grey",
    dashArray = "",
    fillOpacity = 0.3,
    bringToFront = TRUE),
    label = labels,
    labelOptions = labelOptions(
    style = list("font-weight" = "normal", padding = "3px 8px"),
    textsize = "15px",
    direction = "auto")
  )

  
  
```


```{r}
togo_france_sanitation <- overall_sanitation %>%
  filter(country =="France" | country == "Togo")
```




```{r}
#Sanitation of Togo and France
new_sanitation_rate <- gather(togo_france_sanitation, key= "year", value= "sanitation", -country)
```

```{r}
#creating the bar plot
togo_france_sanitation <- new_sanitation_rate %>%
  filter(year == "2015"  )
togo_france_sanitation <- togo_france_sanitation %>%
  mutate(new_year = lubridate::ymd(togo_france_sanitation$year, truncated = 2L))

ggplot(data = togo_france_sanitation, mapping = aes(x = country, y = sanitation, fill= country)) + 
  geom_col() + scale_fill_manual(values=c("#00008b", "#228b22")) + ggtitle("Overall Access to Sanitation Services") +  labs(y="Sanitation", x = "Country")
```




























































































































































































#Eleni
#Child Mortality Rates

```{r}
child_mortality_rate <- read.csv(file = 'child_mortality_per_1000_born.csv')

child_mortality_rate <- child_mortality_rate %>% 
  mutate(new_year = lubridate::ymd(child_mortality_rate$year, truncated = 2L))

ggplot(data = child_mortality_rate) + geom_line(aes(x=new_year,y=france_rate),color='darkblue') + 
           geom_line(aes(x=new_year,y=togo_rate),color='forestgreen') + 
           ylab('Mortality Rate')+xlab('Year')+ggtitle ('Mortality Rate for Togo and France from 2008-2018')

```








































































































